import{r as c,j as t,a}from"./index-30a93734.js";import{T as v}from"./TutorialPeer-87271097.js";import"./WSClient-c3269280.js";function x(){const[d,u]=c.useState("demo"),[m,h]=c.useState("idle"),[o,p]=c.useState("hi"),r=c.useRef(null),i=c.useRef(null),n=c.useRef(null);return c.useEffect(()=>()=>{var e;return(e=n.current)==null?void 0:e.hangup()},[]),t("div",{className:"page",children:a("div",{className:"grid two",children:[a("div",{className:"card",children:[t("div",{className:"card-title",children:"WebRTC 基础"}),a("div",{className:"card-body",children:[a("div",{className:"row gap",children:[t("input",{className:"input",value:d,onChange:e=>u(e.target.value),"aria-label":"房间ID"}),t("button",{className:"btn",onClick:async()=>{const e=new v({roomId:d,polite:!0});e.onStatus=s=>h(`${s.pcState}/${s.dcState}/${s.wsOpen?"ws":"no-ws"}`),e.onRemoteStream=s=>{i.current&&(i.current.srcObject=s)},await e.connect();const l=await e.startLocalMedia({audio:!0,video:!0});r.current&&(r.current.srcObject=l,r.current.muted=!0),n.current=e},children:"连接"}),t("button",{className:"btn",onClick:async()=>{var e;await((e=n.current)==null?void 0:e.call())},children:"发起呼叫"}),t("button",{className:"btn",onClick:()=>{var e;(e=n.current)==null||e.hangup()},children:"挂断"}),a("span",{className:"chip",children:[t("span",{className:"dot"}),m]})]}),a("div",{className:"row gap",children:[t("input",{className:"input",value:o,onChange:e=>p(e.target.value),"aria-label":"文本"}),t("button",{className:"btn",onClick:()=>{var e,l;try{(e=n.current)==null||e.ensureDataChannel(),(l=n.current)==null||l.sendText(o)}catch{}},children:"发送文本"})]})]})]}),a("div",{className:"card",children:[t("div",{className:"card-title",children:"媒体预览"}),t("div",{className:"card-body",children:a("div",{className:"grid two",children:[a("div",{children:[t("div",{className:"muted",children:"本地"}),t("video",{ref:r,playsInline:!0,autoPlay:!0,style:{width:"100%",borderRadius:8}})]}),a("div",{children:[t("div",{className:"muted",children:"远端"}),t("video",{ref:i,playsInline:!0,autoPlay:!0,style:{width:"100%",borderRadius:8}})]})]})})]})]})})}export{x as default};
